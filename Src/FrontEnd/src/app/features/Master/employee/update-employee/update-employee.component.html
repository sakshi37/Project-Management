
<div class="container mt-4">
  <div class="card shadow p-4">
    <h5 class="border-bottom pb-2 mb-4 font-weight-bold">Edit Details</h5>

    <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">
      <!-- Employee Code (Readonly) -->
      <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="employeeCode">Employee Code</label>
          <input
            type="text"
            id="employeeCode"
            class="form-control"
            [value]="selectedEmployeeCode"
            readonly
          />
        </div>
        <div class="col-md-6 form-group">
          <label for="address">Address</label>
          <input
            type="text"
            id="address"
            class="form-control"
            formControlName="address"
            placeholder="Enter address"
          />
        </div>
      </div>

      <!-- Mobile Number & Skype ID -->
      <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="mobileNo">Mobile Number</label>
          <input
            type="text"
            id="mobileNo"
            class="form-control"
            formControlName="mobileNo"
            placeholder="Enter mobile number"
          />
          <div *ngIf="employeeForm.get('mobileNo')?.invalid && (employeeForm.get('mobileNo')?.touched || employeeForm.get('mobileNo')?.dirty)" class="text-danger small">
            <div *ngIf="employeeForm.get('mobileNo')?.errors?.['pattern']">
               Mobile number must be exactly 10 digits and start with 6 to 9.</div>
          </div>
        </div>

        <div class="col-md-6 form-group">
          <label for="skypeId">Skype ID</label>
          <input
            type="text"
            id="skypeId"
            class="form-control"
            formControlName="skypeId"
            placeholder="Enter Skype ID"
          />
          <div *ngIf="employeeForm.get('skypeId')?.invalid && (employeeForm.get('skypeId')?.touched || employeeForm.get('skypeId')?.dirty)" class="text-danger small">
            <div *ngIf="employeeForm.get('skypeId')?.errors?.['minlength']">Skype ID must be at least 16 characters.</div>
            <div *ngIf="employeeForm.get('skypeId')?.errors?.['maxlength']">Skype ID cannot exceed 32 characters.</div>
          </div>
        </div>
      </div>

      <!-- Email & BCC Email -->
      <div class="form-row">
        <div class="col-md-6 form-group">
  <label for="email">Email</label>
  <input
    type="email"
    id="email"
    class="form-control"
    formControlName="email"
    placeholder="Enter email"
  />
  <div *ngIf="employeeForm.get('email')?.invalid && (employeeForm.get('email')?.touched || employeeForm.get('email')?.dirty)" class="text-danger small">
    <div *ngIf="employeeForm.get('email')?.errors?.['pattern']">Please enter a valid email.</div>
  </div>
</div>

<div class="col-md-6 form-group">
  <label for="bccEmail">BCC Email</label>
  <input
    type="email"
    id="bccEmail"
    class="form-control"
    formControlName="bccEmail"
    placeholder="Enter BCC email"
  />
  <div *ngIf="employeeForm.get('bccEmail')?.invalid && (employeeForm.get('bccEmail')?.touched || employeeForm.get('bccEmail')?.dirty)" class="text-danger small">
    <div *ngIf="employeeForm.get('bccEmail')?.errors?.['pattern']">Please enter a valid BCC email.</div>
  </div>
</div>

      </div>

      <!-- PAN Number & Join Date -->
      <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="panNumber">PAN Number</label>
          <input
            type="text"
            id="panNumber"
            class="form-control"
            formControlName="panNumber"
            placeholder="Enter PAN number"
          />
          <div *ngIf="employeeForm.get('panNumber')?.invalid && (employeeForm.get('panNumber')?.touched || employeeForm.get('panNumber')?.dirty)" class="text-danger small">
            <div *ngIf="employeeForm.get('panNumber')?.errors?.['pattern']">PAN must be in format ABCDE1234F.</div>
          </div>
        </div>
          <div class="col-md-6 form-group">
            <label for="aadharCardNo">Aadhaar Card Number</label>
             <input
               type="text"
                id="aadharCardNo"
               class="form-control"
               formControlName="aadharCardNo"
                placeholder="Enter 12-digit Aadhaar number"
                 />
          <div *ngIf="employeeForm.get('aadharCardNo')?.invalid && (employeeForm.get('aadharCardNo')?.touched || employeeForm.get('aadhaarNumber')?.dirty)" class="text-danger small">
                <div *ngIf="employeeForm.get('aadharCardNo')?.errors?.['pattern']">
                   Aadhaar number must be 12 digits.
      </div>
    </div>
  </div>
        
      </div>
      <div class="form-row">
              <!-- Gender -->
      <div class="col-md-6 form-group">
  <label for="genderId">Gender</label>
  <select id="genderId" class="form-select" formControlName="genderId">
    <option value="">Select Gender</option>
    <option *ngFor="let g of genders" [value]="g.genderId">{{ g.genderType }}</option>
  </select>
</div>

       <div class="col-md-6 form-group">
          <label for="birthDate">Birth Date</label>
<input
  type="date"
  id="birthDate"
  class="form-control"
  formControlName="birthDate"
/>
<div *ngIf="employeeForm.get('birthDate')?.invalid && (employeeForm.get('birthDate')?.touched || employeeForm.get('birthDate')?.dirty)" class="text-danger small">
  <div *ngIf="employeeForm.get('birthDate')?.errors?.['required']">Birth date is required.</div>
</div>
        </div>
      </div>

      <!-- Birth Date & Leave Company Date -->
      <div class="form-row">
        
        <div class="col-md-6 form-group">
          <label for="joinDate">Join Date</label>
<input
  type="date"
  id="joinDate"
  class="form-control"
  formControlName="joinDate"
/>
<div *ngIf="employeeForm.get('joinDate')?.invalid && (employeeForm.get('joinDate')?.touched || employeeForm.get('joinDate')?.dirty)" class="text-danger small">
  <div *ngIf="employeeForm.get('joinDate')?.errors?.['required']">Join date is required.</div>
</div>

<!-- Show errors for the form group -->
<div *ngIf="employeeForm.errors?.['futureDate'] && (employeeForm.get('birthDate')?.touched || employeeForm.get('joinDate')?.touched)" class="text-danger small">
  Birth date or Join date cannot be a future date.
</div>
<div *ngIf="employeeForm.errors?.['minAgeGap'] && (employeeForm.get('birthDate')?.touched || employeeForm.get('joinDate')?.touched)" class="text-danger small">
  Join Date must be at least 18 years after Birth Date.
</div>
        </div>

        <div class="col-md-6 form-group">
          <label for="leaveCompany">Leave Company Date</label>
          <input
            type="date"
            id="leaveCompany"
            class="form-control"
            formControlName="leaveCompany"
          />
          <div *ngIf="employeeForm.get('leaveCompany')?.invalid && (employeeForm.get('leaveCompany')?.touched || employeeForm.get('leaveCompany')?.dirty)" class="text-danger small">
            <div *ngIf="employeeForm.get('leaveCompany')?.errors?.['futureDate']">Cannot be a future date.</div>
          </div>
        </div>
      </div>

      <!-- Remaining dropdowns (Status, Branch, etc.) -->
      <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="loginStatus">Login Status</label>
          <select id="loginStatus" class="form-control" formControlName="loginStatus">
             <option  [ngValue]="true">Active</option>
            <option  [ngValue]="false">Inactive</option>
          </select>
        </div>

        <div class="col-md-6 form-group">
          <label for="leftCompany">Left Company</label>
          <select id="leftCompany" class="form-control" formControlName="leftCompany">
            <option [value]="true">Yes</option>
            <option [value]="false">No</option>
          </select>
        </div>
      </div>

      <!-- File Uploads -->
      <div class="form-row">
  <div class="col-md-6 form-group">
    <label for="imageUpload">Upload Image</label>
    <input
      type="file"
      id="imageUpload"
      class="form-control"
      accept="image/*"
      (change)="onImageSelected($event)"
    />
    <div *ngIf="imagePreview">
      <img [src]="imagePreview" alt="Image Preview" class="img-thumbnail mt-2" style="max-height: 200px;" />
    </div>
  </div>

  <div class="col-md-6 form-group">
    <label for="signatureUpload">Upload Signature</label>
    <input
      type="file"
      id="signatureUpload"
      class="form-control"
      accept="image/*"
      (change)="onSignatureSelected($event)"
    />
    <div *ngIf="signaturePreview">
      <img [src]="signaturePreview" alt="Signature Preview" class="img-thumbnail mt-2" style="max-height: 200px;" />
    </div>
  </div>
</div>

     <!-- <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="imageUpload">Upload Image</label>
          <input type="file" id="imageUpload" class="form-control" (change)="onImageSelected($event)" />
        </div>
        <div class="col-md-6 form-group">
          <label for="signatureUpload">Upload Signature</label>
          <input type="file" id="signatureUpload" class="form-control" (change)="onSignatureSelected($event)" />
        </div>
      </div> -->

      <!-- Dropdowns: Location, Designation, Shift, etc. -->
       <!-- Country, State, City, Gender, Aadhaar Number -->
<div class="form-row">
  <!-- Country -->
  <div class="col-md-6 form-group">
    <label for="country">Country</label>
    <select id="country" class="form-control" formControlName="countryId" >
      <option value="">Select Country</option>
      <option *ngFor="let c of countries" [value]="c.countryId">{{ c.countryName }}</option>
    </select>
  </div>

  <!-- State -->
  <div class="col-md-6 form-group">
    <label for="state">State</label>
    <select  id="stateId"class="form-control" formControlName="stateId" >
      <option value="">Select State</option>
      <option *ngFor="let s of filteredStates" [value]="s.stateId">{{ s.stateName }}</option>
    </select>
  </div>
</div>
      <div class="form-row">
         <!-- City -->
         <div class="col-md-6 form-group">
             <label for="city">City</label>
                 <select id="city" class="form-control" formControlName="cityId">
                 <option value="">Select City</option>
                 <option *ngFor="let c of filteredCities" [value]="c.cityId">{{ c.cityName }}</option>
                 </select>
          </div>
         <div class="col-md-6 form-group">
  <label for="location">Location</label>
  <select id="location" class="form-control" formControlName="locationId">
    <option value="" >Select Location</option>  <!-- placeholder -->
    <option *ngFor="let loc of locations" [value]="loc.locationId">{{ loc.locationName }}</option>
  </select>
</div>

        
      </div>

      <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="designationId">Designation</label>
          <select id="designationId" class="form-control" formControlName="designationId">
            <option value="">Select Designation</option>
            <option *ngFor="let des of designations" [value]="des.designationId">{{ des.designationName }}</option>
          </select>
        </div>
        <div class="col-md-6 form-group">
          <label for="branchId">Branch</label>
          <select id="branchId" class="form-control" formControlName="branchId" aria-placeholder="">
            <option value="">Select Branch</option>
            <option *ngFor="let b of branches" [value]="b.branchId">{{ b.branchName }}</option>
          </select>
        </div>
      </div>

      <!-- Final dropdown rows -->
      <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="shiftId">Shift</label>
          <select id="shiftId" class="form-control" formControlName="shiftId">
            <option value="">Select Shift</option>
            <option *ngFor="let s of shifts" [value]="s.shiftId">{{ s.shiftType }}</option>
          </select>
        </div>
        <div class="col-md-6 form-group">
          <label for="employeeTypeId">Employee Type</label>
          <select id="employeeTypeId" class="form-control" formControlName="employeeTypeId">
            <option value="">Select Employee Type</option>
            <option *ngFor="let t of employeeTypes" [value]="t.employeeTypeId">{{ t.employeeType }}</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="col-md-6 form-group">
          <label for="userGroupId">User Group</label>
          <select id="userGroupId" class="form-control" formControlName="userGroupId">
            <option value="">Select User Group</option>
            <option *ngFor="let ug of userGroups" [value]="ug.userGroupId">{{ ug.userGroupName }}</option>
          </select>
        </div>
        <div class="col-md-6 form-group">
          <label for="divisionId">Division</label>
          <select id="divisionId" class="form-control" formControlName="divisionId">
            <option value="">Select Division</option>
            <option *ngFor="let d of divisions" [value]="d.divisionId">{{ d.divisionName }}</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        
      </div>

      <!-- Save and Cancel Buttons -->
      <div class="form-group text-right mt-4">
        <button type="button" class="btn btn-outline-secondary mr-2" (click)="cancel()">Cancel</button>
        <button type="submit" class="btn btn-success" [disabled]="employeeForm.invalid">Save</button>
      </div>
    </form>
  </div>
</div>
